{"version":3,"sources":["routes.js","../provider/editor.js","../component/editor/distributor/distributor!tpl","../../taoBlueprintsCss/distributor!css","../component/editor/distributor/distributor.js","../component/editor/propertySelector/selector!tpl","../component/editor/propertySelector/listItem!tpl","css!taoBlueprintsCss/property-selector","../component/editor/propertySelector/selector.js","../component/editor/editor!tpl","../../taoBlueprintsCss/editor!css","../component/editor/editor.js","Blueprints/editInstance.js","../../../../../../../../../../../../onLayerEnd0.js"],"names":["define","Blueprints","actions","editInstance","_","__","url","request","Promise","defaultConfig","get","route","save","getSelection","config","defaults","uri","resolve","reject","isEmpty","TypeError","values","isPlainObject","selection","hb","template","Handlebars","depth0","helpers","partials","data","program1","stack1","helper","options","buffer","escapeExpression","property","label","functionType","apply","hash","call","helperMissing","program3","depth1","key","value","min","max","program5","inverse","self","program","program8","fn","programWithDepth","program6","this","compilerInfo","merge","noop","each","$","component","incrementer","width","height","$container","distributor","getValues","$component","is","getElement","$elt","$input","length","val","on","render","trigger","defer","setTemplate","init","program4","program2","tree","childList","selectorTpl","listItemTpl","buildTree","nodeToListItem","acc","node","item","pick","children","reduce","propertySelector","getSelected","$selected","hasClass","text","$options","e","preventDefault","toggleClass","$target","size","availableProperties","distributorComponent","propertySelectorComponent","editorTpl","$distributorContainer","$propertySelectorContainer","selector","editor","refresh","disable","destroy","enable","loadingBar","feedback","editorProvider","editorComponent","provider","onError","err","error","message","stop","start","$editorContainer","then","propUri","propLabel","catch","success","c","d","document","a","i","s","createElement","type","getElementsByTagName","cssText","createTextNode"],"mappings":"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","file":"routes.js.map","sourcesContent":["define('taoBlueprints/controller/routes',[],function() {\n    'use strict';\n\n    return {\n        'Blueprints' : {\n            actions : {\n                'editInstance' : 'controller/Blueprints/editInstance'\n            }\n        }\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * Provides blueprints editor data\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBlueprints/provider/editor',[\n    'lodash',\n    'i18n',\n    'util/url',\n    'core/dataProvider/request',\n    'core/promise'\n], function( _, __, url, request, Promise){\n    'use strict';\n\n    /**\n     * Per function requests configuration.\n     */\n    var defaultConfig = {\n        get: {\n            url : url.route('get', 'Editor', 'taoBlueprints')\n        },\n        save : {\n            url : url.route('save', 'Editor', 'taoBlueprints')\n        },\n        getSelection : {\n            url : url.route('getSelection', 'Editor', 'taoBlueprints')\n        }\n    };\n\n\n    /**\n     * Creates a configured editor provider\n     *\n     * @param {Object} [config] - to override the default config\n     * @returns {editorProvider} the new provider\n     */\n    return function editorProviderFactory(config){\n\n        config = _.defaults(config || {}, defaultConfig);\n\n        /**\n         * @typedef {editorProvider}\n         */\n        return {\n\n            /**\n             * Get blueprint's editor data\n             * @param {String} uri - the blueprint URI\n             * @returns {Promise} that resolves with the data\n             */\n            get: function get(uri){\n                return new Promise(function(resolve, reject){\n\n                    if(_.isEmpty(uri)){\n                        return reject(new TypeError('The blueprint URI parameter must be provided'));\n                    }\n\n                    return resolve(request(config.get.url, { uri : uri }));\n                });\n\n            },\n\n            /**\n             * Save blueprint's editor data\n             * @param {String} uri - the blueprint URI\n             * @param {Object} values - the blueprint's data to save, we check only the selection member\n             * @returns {Promise} that resolves if saved\n             */\n            save : function save(uri, values){\n                return new Promise(function(resolve, reject){\n\n                    if(_.isEmpty(uri)){\n                        return reject(new TypeError('The blueprint URI parameter must be provided'));\n                    }\n                    if(!_.isPlainObject(values) || !values.selection){\n                        return reject(new TypeError('The values parameter must be provided'));\n                    }\n\n                    return resolve(request(config.save.url, { uri : uri, values : values }));\n                });\n            },\n\n            /**\n             * Loads a selection for a particular property\n             * @param {String} uri - the property URI\n             * @returns {Promise} that resolves with the selection data\n             */\n            getSelection : function getSelection(uri){\n\n                return new Promise(function(resolve, reject){\n\n                    if(_.isEmpty(uri)){\n                        return reject(new TypeError('The property URI parameter must be provided'));\n                    }\n\n                    return resolve(request(config.getSelection.url, { uri : uri }));\n                });\n\n            }\n        };\n    };\n});\n\n","\ndefine('tpl!taoBlueprints/component/editor/distributor/distributor', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n    <header class=\\\"row\\\">\\n        <div class=\\\"label\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.data)),stack1 == null || stack1 === false ? stack1 : stack1.property)),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</div>\\n        <div class=\\\"count\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Item Count\", options) : helperMissing.call(depth0, \"__\", \"Item Count\", options)))\n    + \"</div>\\n    </header>\\n    \";\n  return buffer;\n  }\n\nfunction program3(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n        <li class=\\\"row\\\" data-uri=\\\"\"\n    + escapeExpression(((stack1 = (data == null || data === false ? data : data.key)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\">\\n            <div class=\\\"label\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</div>\\n            <div class=\\\"count\\\">\\n                <input type=\\\"text\\\" value=\\\"\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\" data-increment=\\\"1\\\" data-min=\\\"\"\n    + escapeExpression(((stack1 = (depth1 && depth1.min)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-max=\\\"\"\n    + escapeExpression(((stack1 = (depth1 && depth1.max)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" data-zero />\\n            </div>\\n        </li>\\n    \";\n  return buffer;\n  }\n\nfunction program5(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\n        <li class=\\\"empty\\\"><em>\\n        \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth1 && depth1.data)),stack1 == null || stack1 === false ? stack1 : stack1.property)),stack1 == null || stack1 === false ? stack1 : stack1.label), {hash:{},inverse:self.program(8, program8, data),fn:self.programWithDepth(6, program6, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        </em></li>\\n    \";\n  return buffer;\n  }\nfunction program6(depth0,data,depth1) {\n  \n  var buffer = \"\", stack1, helper, options;\n  buffer += \"\\n            \"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth1 && depth1.data)),stack1 == null || stack1 === false ? stack1 : stack1.property)),stack1 == null || stack1 === false ? stack1 : stack1.label)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \" \"\n    + escapeExpression((helper = helpers.__ || (depth1 && depth1.__),options={hash:{},data:data},helper ? helper.call(depth0, \"has no resources.\", options) : helperMissing.call(depth0, \"__\", \"has no resources.\", options)))\n    + \"\\n        \";\n  return buffer;\n  }\n\nfunction program8(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n            \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"No property defined, please select a property.\", options) : helperMissing.call(depth0, \"__\", \"No property defined, please select a property.\", options)))\n    + \"\\n        \";\n  return buffer;\n  }\n\n  buffer += \"<section class=\\\"distributor\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.data)),stack1 == null || stack1 === false ? stack1 : stack1.property)),stack1 == null || stack1 === false ? stack1 : stack1.label), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    <ul>\\n    \";\n  stack1 = helpers.each.call(depth0, ((stack1 = (depth0 && depth0.data)),stack1 == null || stack1 === false ? stack1 : stack1.selection), {hash:{},inverse:self.programWithDepth(5, program5, data, depth0),fn:self.programWithDepth(3, program3, data, depth0),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </ul>\\n</section>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoBlueprintsCss/distributor',[],function(){});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * This component handles the item count distribution\n * as part of the test blueprint editor.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBlueprints/component/editor/distributor/distributor',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'ui/component',\n    'ui/incrementer',\n    'tpl!taoBlueprints/component/editor/distributor/distributor',\n    'css!taoBlueprintsCss/distributor.css'\n], function($, _, __, component, incrementer, template){\n    'use strict';\n\n    var defaultConfig = {\n        width: 'auto',\n        height: 300,\n        min : 0,\n        max : 99\n    };\n\n    /**\n     * Build a brand new distributor component\n     *\n     * @param {jQueryElement} $container - where to append the component\n     * @param {Object} [config] - set the configuration\n     * @param {Object} [config.data] - set the component data\n     * @param {String} config.data.uri - set the URI of the main property\n     * @param {String} config.data.label - set the label of the property\n     * @param {Object} config.data.selection - the property range instances as `uri : {label : String, count : Number}`\n     * @param {String|Number} [config.width] - the component width\n     * @param {String|Number} [config.height] - the component height\n     * @param {Number} [config.min] - the min value for the count\n     * @param {Number} [config.max] - the max value for the count\n     *\n     * @returns {distributorComponent} the component\n     */\n    return function distributorFactory($container, config){\n\n\n        /**\n         * @typedef {distributorComponent} The component itself\n         */\n        var distributor = component({\n\n            /**\n             * Get the values from the DOM\n             * @returns {Object} the values as `{uri : count}`\n             */\n            getValues : function getValues(){\n                var self = this;\n                var $component;\n                var values = {};\n                if(this.is('rendered')) {\n                    $component = this.getElement();\n\n                    $('.row', $component).each(function(){\n                        var $elt   = $(this);\n                        var $input = $(':text', $elt);\n                        var uri    = $elt.data('uri');\n                        if(uri && $input.length === 1 && self.config.data.selection[uri]){\n                            values[uri] = {\n                                label : self.config.data.selection[uri].label,\n                                value : $input.val()\n                            };\n                        }\n                    });\n                }\n                return values;\n            }\n        }, defaultConfig);\n\n        distributor\n            .on('init', function(){\n                this.render($container);\n            })\n            .on('render', function(){\n                var self       = this;\n                var $component = this.getElement();\n\n                $component.on('change', function(){\n\n                    /**\n                     * @event distributorComponent#change the values have changed\n                     * @param {Object} values - the current values\n                     */\n                    self.trigger('change', self.getValues());\n                });\n\n                incrementer($component);\n            })\n            .on('disable', function(){\n                if(this.is('rendered')){\n                    $(':text[data-increment]', this.getElement()).trigger('disable.incrementer');\n                }\n            })\n            .on('enable', function(){\n                if(this.is('rendered')){\n                    $(':text[data-increment]', this.getElement()).trigger('enable.incrementer');\n                }\n            });\n\n        //defer the init so the consumer can listen for the events\n        _.defer(function(){\n            distributor\n                .setTemplate(template)\n                .init(config);\n        });\n\n        return distributor;\n    };\n});\n\n","\ndefine('tpl!taoBlueprints/component/editor/propertySelector/selector', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, helperMissing=helpers.helperMissing, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n        \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.uri), {hash:{},inverse:self.program(4, program4, data),fn:self.program(2, program2, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        <div class=\\\"options folded\\\">\\n            <ul>\";\n  if (helper = helpers.tree) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.tree); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"</ul>\\n        </div>\\n    \";\n  return buffer;\n  }\nfunction program2(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n        <a href=\\\"#\\\" class=\\\"selected\\\" data-uri=\\\"\";\n  if (helper = helpers.uri) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.uri); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</a>\\n        \";\n  return buffer;\n  }\n\nfunction program4(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n        <a href=\\\"#\\\" class=\\\"selected empty\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Please select a property\", options) : helperMissing.call(depth0, \"__\", \"Please select a property\", options)))\n    + \"</a>\\n        \";\n  return buffer;\n  }\n\nfunction program6(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n       <span class=\\\"txt-warning nothing\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"No eligible property\", options) : helperMissing.call(depth0, \"__\", \"No eligible property\", options)))\n    + \"</span>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"property-selector\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.tree), {hash:{},inverse:self.program(6, program6, data),fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('tpl!taoBlueprints/component/editor/propertySelector/listItem', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n        <ul>\\n            \";\n  if (helper = helpers.childList) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.childList); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n        </ul>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<li>\\n    <a href=\\\"#\\\" data-uri=\\\"\";\n  if (helper = helpers.uri) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.uri); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</a>\\n    \";\n  stack1 = helpers['if'].call(depth0, (depth0 && depth0.childList), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</li>\\n\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoBlueprintsCss/property-selector',[],function(){});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA ;\n */\n\n/**\n * This component let's you select a propery in a list.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBlueprints/component/editor/propertySelector/selector',[\n    'jquery',\n    'lodash',\n    'ui/component',\n    'tpl!taoBlueprints/component/editor/propertySelector/selector',\n    'tpl!taoBlueprints/component/editor/propertySelector/listItem',\n    'css!taoBlueprintsCss/property-selector.css'\n], function ($, _, component, selectorTpl, listItemTpl) {\n    'use strict';\n\n    /**\n     * Build the selection list/tree\n     * @param {Object[]} data - as { uri, label, children } where children contains the same structure\n     * @returns {String} the selection as HTML\n     */\n    var buildTree = function buildTree(data){\n        var nodeToListItem = function nodeToListItem(acc , node){\n            var item = _.pick(node, ['uri', 'label']);\n            if(node.children && node.children.length){\n                item.childList = _.reduce(node.children, nodeToListItem, '');\n            }\n            acc += listItemTpl(item);\n            return acc;\n        };\n\n        return _.reduce(data, nodeToListItem, '');\n    };\n\n    /**\n     * Build a new component\n     *\n     * @param {jQueryElement} $container - where to append the component\n     * @param {Object} [config] - set the configuration\n     * @param {String} [config.uri] - set the URI of the selected property\n     * @param {String} [config.label] - set the label of the selected property\n     * @param {Object} [config.data] - the selection data as [{uri, label, children}]\n     *\n     * @returns {propertySelectorComponent} the component\n     */\n    return function classesSelectorFactory($container, config){\n\n        /**\n         * @typedef {propertySelectorComponent} The component itself\n         */\n        var propertySelector = component({\n\n            /**\n             * Get the selected values\n             * @returns {Object} that contains the URI and the label of the selected property\n             */\n            getSelected : function getSelected(){\n                var $component = this.getElement();\n                var $selected  = $('.selected', $component);\n                if($selected.length && !$selected.hasClass('empty')){\n                    return {\n                        label : $selected.text(),\n                        uri   : $selected.data('uri')\n                    };\n                }\n                return false;\n            }\n        }, {});\n\n        propertySelector\n            .setTemplate(selectorTpl)\n            .on('init', function(){\n                this.render($container);\n            })\n            .on('render', function(){\n                var self = this;\n                var $component = this.getElement();\n                var $selected  = $('.selected', $component);\n                var $options   = $('.options', $component);\n\n                $selected.on('click', function(e){\n                    e.preventDefault();\n                    $options.toggleClass('folded');\n                });\n\n                $options.on('click', 'a', function(e){\n                    var $target = $(this);\n                    var label = $target.text();\n                    var uri = $target.data('uri');\n\n                    e.preventDefault();\n\n                    $selected.text(label)\n                            .data('uri', uri);\n                    $options.toggleClass('folded');\n\n                    /**\n                     * @event propertySelectorComponent#change the selected value has changed\n                     * @param {String} uri - the new property URI\n                     * @param {String} label - the new property label\n                     */\n                    self.trigger('change', uri, label);\n                });\n            });\n\n        //defer the init so the consumer can listen for the events\n        _.defer(function(){\n            if(config.data && _.size(config.data) > 0){\n                config.tree = buildTree(config.data);\n            }\n            propertySelector.init(config);\n        });\n\n        return propertySelector;\n\n    };\n});\n\n","\ndefine('tpl!taoBlueprints/component/editor/editor', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, helper, options, helperMissing=helpers.helperMissing, escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", helper, options;\n  buffer += \"\\n    <div class=\\\"distributor-container\\\"></div>\\n    <div class=\\\"controls\\\">\\n        <button class=\\\"btn-info small saver\\\"><span class=\\\"icon-save\\\"></span> \"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Save\", options) : helperMissing.call(depth0, \"__\", \"Save\", options)))\n    + \"</button>\\n    </div>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<section class=\\\"blueprint-editor form-content\\\">\\n    <div class=\\\"form-row\\\">\\n        <label for=\\\"label\\\">\"\n    + escapeExpression((helper = helpers.__ || (depth0 && depth0.__),options={hash:{},data:data},helper ? helper.call(depth0, \"Target Property\", options) : helperMissing.call(depth0, \"__\", \"Target Property\", options)))\n    + \"</label>\\n        <div class=\\\"property-selector-container\\\"></div>\\n    </div>\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = (depth0 && depth0.data)),stack1 == null || stack1 === false ? stack1 : stack1.availableProperties), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</section>\\n\";\n  return buffer;\n  });\n});\n\n","\ndefine('css!taoBlueprintsCss/editor',[],function(){});\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * This component let's you edit a test blueprint.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBlueprints/component/editor/editor',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'ui/component',\n    'taoBlueprints/component/editor/distributor/distributor',\n    'taoBlueprints/component/editor/propertySelector/selector',\n    'tpl!taoBlueprints/component/editor/editor',\n    'css!taoBlueprintsCss/editor.css'\n], function($, _, __, component, distributorComponent, propertySelectorComponent, editorTpl){\n    'use strict';\n\n    /**\n     * The default config\n     */\n    var defaultConfig = {\n        width:  500,\n        height: 430,\n        data : {\n            property: false,\n            availableProperties : {},\n            selection : {}\n        }\n    };\n\n    /**\n     * Build a brand new editor component\n     *\n     * @param {jQueryElement} $container - where to append the component\n     * @param {Object} [config] - set the configuration\n     * @param {Object} [config.data] - set the component data\n     * @param {Object} [config.data.property] - set the component data\n     * @param {Object} [config.data.availableProperties] - set the component data\n     * @param {Object} [config.data.selection] - set the component data\n     * @param {String|Number} [config.width] - the component width\n     * @param {String|Number} [config.height] - the component height\n     *\n     * @returns {editorComponent} the component\n     */\n    return function editorFactory($container, config){\n\n        var $distributorContainer;\n        var $propertySelectorContainer;\n        var distributor;\n        var selector;\n\n        /**\n         * @typedef {editorComponent} The component itself\n         */\n        var editor = component({\n\n            /**\n             * Refresh the editor content, usually when a new target property is selected.\n             * It's not done \"on change\" by default to separate data access to display,\n             * especially since the new selection has to be loaded somewhere else.\n             * @param {String} uri - the new property URI\n             * @param {String} label - the new property label\n             * @param {Object} selection - the new selection conten\n             * @returns {editorComponent} chains\n             * @fires editorComponent#refresh\n             */\n            refresh : function refresh(uri, label, selection){\n                var self       = this;\n\n                if( this.is('rendered') ) {\n                    this.disable();\n\n                    if (distributor){\n                        distributor.destroy();\n                    }\n                    this.config.data.property = {\n                        uri : uri,\n                        label : label\n                    };\n                    this.config.data.selection = selection;\n\n                    distributor = distributorComponent($distributorContainer, _.pick(this.config, ['data']))\n                    .on('render', function(){\n                        self.enable();\n\n                        /**\n                         * @event editorComponent#refresh a new selection has been loaded\n                         */\n                        self.trigger('refresh');\n                    });\n                }\n\n                return this;\n            },\n\n            /**\n             * Get the editor's values\n             * @returns {Object} the values with the selected property and the selection.\n             */\n            getValues : function getValues() {\n                var values = _.pick(this.config.data, ['selection', 'property']);\n                if(distributor){\n                    values.selection = distributor.getValues();\n                }\n                return values;\n            }\n\n        }, defaultConfig);\n\n        editor\n            .on('init', function(){\n                this.render($container);\n            })\n            .on('render', function(){\n                var self       = this;\n                var $component = this.getElement();\n\n                $distributorContainer      = $('.distributor-container', $component);\n                $propertySelectorContainer = $('.property-selector-container', $component);\n\n                distributor = distributorComponent($distributorContainer, _.pick(config, 'data'));\n                selector = propertySelectorComponent($propertySelectorContainer, {\n                    uri:   config.data.property.uri,\n                    label: config.data.property.label,\n                    data:  config.data.availableProperties || {}\n                })\n                .on('change', function(uri, label){\n\n                    /**\n                     * @event editorComponent#propertyChange a new property is selected\n                     * @param {String} uri - the new propery URI\n                     * @param {String} label - the new property label\n                     */\n                    self.trigger('propertyChange', uri, label);\n                });\n\n                $('.saver', $component).on('click', function(e){\n                    e.preventDefault();\n\n                    if (!self.is('disabled')){\n                        /**\n                        * @event editorComponent#save the editor asks you to save it's content\n                        * @param {Object} values - with the selected property and the selection.\n                        */\n                        self.trigger('save', self.getValues());\n                    }\n                });\n            })\n            .on('disable', function(){\n                if(distributor) {\n                    distributor.disable();\n                }\n                if(selector){\n                    selector.disable();\n                }\n            })\n            .on('enable', function(){\n                if(distributor) {\n                    distributor.enable();\n                }\n                if(selector){\n                    selector.enable();\n                }\n            });\n\n        //defer the init so the consumer can listen for the events\n        _.defer(function(){\n            editor\n                .setTemplate(editorTpl)\n                .init(config);\n        });\n\n        return editor;\n    };\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2016 (original work) Open Assessment Technologies SA;\n */\n\n/**\n * This controller set up the blueprint editor component and manages\n * the data handling through the provider.\n *\n * @author Bertrand Chevrier <bertrand@taotesting.com>\n */\ndefine('taoBlueprints/controller/Blueprints/editInstance',[\n    'jquery',\n    'i18n',\n    'layout/loading-bar',\n    'ui/feedback',\n    'taoBlueprints/provider/editor',\n    'taoBlueprints/component/editor/editor'\n], function($, __, loadingBar, feedback, editorProvider, editorComponent){\n    'use strict';\n\n    /**\n     * Instantiate the editor provider, once.\n     */\n    var provider = editorProvider();\n\n    /**\n     * Display error message\n     * @param {Error} err - the calling error\n     */\n    var onError = function onError(err){\n        feedback().error(err.message);\n        loadingBar.stop();\n    };\n\n    /**\n     * The controller\n     */\n    return {\n\n        /**\n         * Ususal controller entrypoint\n         */\n        start : function start(){\n\n            var $editorContainer = $('.blueprint-editor-container');\n            var uri = $editorContainer.data('uri');\n            if($editorContainer.length && uri) {\n\n                loadingBar.start();\n\n                provider\n                    .get(uri)\n                    .then(function(data){\n\n                        editorComponent($editorContainer, {\n                            data: data\n                        })\n                        .on('render', function(){\n                            loadingBar.stop();\n                        })\n                        .on('propertyChange', function(propUri, propLabel){\n                            var self = this;\n\n                            provider\n                                .getSelection(propUri)\n                                .then(function(selection){\n                                    self.refresh(propUri, propLabel, selection);\n                                })\n                                .catch(onError);\n                        })\n                        .on('save', function(values){\n\n                            provider\n                                .save(uri, values)\n                                .then(function(){\n                                    feedback().success(__('Blueprint saved'));\n                                })\n                                .catch(onError);\n                        });\n                    })\n                    .catch(onError);\n            }\n        }\n    };\n\n});\n\n","\n(function(c){var d=document,a='appendChild',i='styleSheet',s=d.createElement('style');s.type='text/css';d.getElementsByTagName('head')[0][a](s);s[i]?s[i].cssText=c:s[a](d.createTextNode(c));})\n('.distributor{position:relative;overflow:hidden;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;height:100%;background-color:#fff}.distributor .row{height:40px;display:box;display:-ms-flexbox;display:-webkit-flexbox;display:flexbox;display:-ms-flex;display:-webkit-flex;display:flex;-ms-direction:row;-webkit-direction:row;direction:row;-ms-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;flex-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;flex-line-pack:start;-ms-flex-line-pack:start;-webkit-align-content:flex-start;align-content:flex-start;flex-align:stretch;-ms-flex-align:stretch;-webkit-align-items:stretch;align-items:stretch}.distributor .row>.label{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:1 1 auto;-webkit-flex:1 1 auto;flex:1 1 auto;-ms-flex:1 1;-webkit-flex:1 1;flex:1 1;padding:10px}.distributor .row>.count{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 100px;-webkit-flex:0 0 100px;flex:0 0 100px;padding:10px}.distributor header{background-color:#D4D5D7}.distributor header.row>.count{padding-left:0}.distributor ul{padding:0;margin:0;overflow-y:auto;list-style-type:none;height:calc(100% - 40px)}.distributor ul .row:nth-child(even){background-color:white}.distributor ul .row:nth-child(odd){background-color:#f4f7f8}.distributor ul .row>.count{padding:5px 10px}.distributor ul .empty{text-align:center}\\n/*# sourceMappingURL=distributor.css.map */\\n.property-selector{padding:5px 0;position:relative}.property-selector a.selected{display:inline-block;position:relative;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;border-radius:3px;padding:3px 10px;text-decoration:none;width:100%}.property-selector a.selected:after{font-family:\\'tao\\' !important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;content:\\\"\\\\e611\\\";position:absolute;right:10px;top:7px}.property-selector .nothing{display:inline-block;position:relative;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;border-radius:3px;padding:3px 10px;width:100%;color:#c96043;background-color:#fff}.property-selector .nothing:before{font-family:\\'tao\\' !important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;content:\\\"\\\\e63b\\\";margin-right:3px}.property-selector .options{position:absolute;width:100%;background-color:#f3f1ef;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;left:0;margin-top:0;overflow-y:auto;z-index:100;max-height:300px;-webkit-transition:max-height, 300ms, ease;-moz-transition:max-height, 300ms, ease;-ms-transition:max-height, 300ms, ease;-o-transition:max-height, 300ms, ease;transition:max-height, 300ms, ease}.property-selector .options.folded{overflow:hidden;max-height:0;-webkit-transition:max-height, 300ms, ease;-moz-transition:max-height, 300ms, ease;-ms-transition:max-height, 300ms, ease;-o-transition:max-height, 300ms, ease;transition:max-height, 300ms, ease;border-width:0}.property-selector .options ul{list-style-type:none;padding:0;margin:0 0 0 15px}.property-selector .options ul li{padding-top:5px}.property-selector .options ul li:before{font-family:\\'tao\\' !important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;content:\\\"\\\\e602\\\";color:#266d9c;top:2px;margin-right:5px}\\n/*# sourceMappingURL=property-selector.css.map */\\n.blueprint-editor{border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;background-color:#f3f1ef;position:relative;opacity:0;-webkit-transition:opacity, 400ms, linear;-moz-transition:opacity, 400ms, linear;-ms-transition:opacity, 400ms, linear;-o-transition:opacity, 400ms, linear;transition:opacity, 400ms, linear}.blueprint-editor.rendered{opacity:1;-webkit-transition:opacity, 400ms, linear;-moz-transition:opacity, 400ms, linear;-ms-transition:opacity, 400ms, linear;-o-transition:opacity, 400ms, linear;transition:opacity, 400ms, linear}.blueprint-editor .form-row{display:box;display:-ms-flexbox;display:-webkit-flexbox;display:flexbox;display:-ms-flex;display:-webkit-flex;display:flex;-ms-direction:row;-webkit-direction:row;direction:row;-ms-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;flex-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;flex-line-pack:start;-ms-flex-line-pack:start;-webkit-align-content:flex-start;align-content:flex-start;flex-align:stretch;-ms-flex-align:stretch;-webkit-align-items:stretch;align-items:stretch;padding:10px}.blueprint-editor .form-row>label{margin:0;padding:0;line-height:40px;-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 120px;-webkit-flex:0 0 120px;flex:0 0 120px}.blueprint-editor .form-row>input,.blueprint-editor .form-row>div{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:1 1 auto;-webkit-flex:1 1 auto;flex:1 1 auto;-ms-flex:1 1;-webkit-flex:1 1;flex:1 1}.blueprint-editor .distributior-container{padding:10px}.blueprint-editor .controls{padding:10px;text-align:right}\\n/*# sourceMappingURL=editor.css.map */\\n');\n"]}