define("taoBlueprints/provider/editor",["lodash","i18n","util/url","core/dataProvider/request","core/promise"],function(_,__,url,request,Promise){"use strict";var defaultConfig={get:{url:url.route("get","Editor","taoBlueprints")},save:{url:url.route("save","Editor","taoBlueprints")},getSelection:{url:url.route("getSelection","Editor","taoBlueprints")}};return function(config){return config=_.defaults(config||{},defaultConfig),{get:function(uri){return new Promise(function(resolve,reject){return _.isEmpty(uri)?reject(new TypeError("The blueprint URI parameter must be provided")):resolve(request(config.get.url,{uri:uri}))})},save:function(uri,values){
return new Promise(function(resolve,reject){return _.isEmpty(uri)?reject(new TypeError("The blueprint URI parameter must be provided")):_.isPlainObject(values)&&values.selection?resolve(request(config.save.url,{uri:uri,values:values})):reject(new TypeError("The values parameter must be provided"))})},getSelection:function(uri){return new Promise(function(resolve,reject){return _.isEmpty(uri)?reject(new TypeError("The property URI parameter must be provided")):resolve(request(config.getSelection.url,{uri:uri}))})}}}}),define("tpl!taoBlueprints/component/editor/distributor/distributor",["handlebars"],function(hb){return hb.template(function(stack1,depth0,
helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,stack1.helpers),data=data||{};var buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,self=this;function program6(depth0,options,helper){var stack1,buffer="";return buffer+="\n            "+escapeExpression(typeof(stack1=null==(stack1=null==(stack1=helper&&helper.data)||!1===stack1?stack1:stack1.property)||!1===stack1?stack1:stack1.label)===functionType?stack1.apply(depth0):stack1)+" "+escapeExpression((options={hash:{},data:options},(helper=helpers.__||helper&&helper.__)?helper.call(depth0,"has no resources.",options
):helperMissing.call(depth0,"__","has no resources.",options)))+"\n        "}function program8(depth0,helper){var options,buffer="";return buffer+="\n            "+escapeExpression((options={hash:{},data:helper},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"No property defined, please select a property.",options):helperMissing.call(depth0,"__","No property defined, please select a property.",options)))+"\n        "}return buffer+='<section class="distributor">\n    ',!(stack1=helpers.if.call(depth0,null==(stack1=null==(stack1=depth0&&depth0.data)||!1===stack1?stack1:stack1.property)||!1===stack1?stack1:stack1.label,{hash:{},inverse:self.noop,
fn:self.program(1,function(depth0,helper){var options,buffer="";return buffer+='\n    <header class="row">\n        <div class="label">'+escapeExpression(typeof(options=null==(options=null==(options=depth0&&depth0.data)||!1===options?options:options.property)||!1===options?options:options.label)===functionType?options.apply(depth0):options)+'</div>\n        <div class="count">'+escapeExpression((options={hash:{},data:helper},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Item Count",options):helperMissing.call(depth0,"__","Item Count",options)))+"</div>\n    </header>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),
buffer+="\n    <ul>\n    ",!(stack1=helpers.each.call(depth0,null==(stack1=depth0&&depth0.data)||!1===stack1?stack1:stack1.selection,{hash:{},inverse:self.programWithDepth(5,function(depth0,data,stack1){var buffer="";return buffer+='\n        <li class="empty"><em>\n        ',!(stack1=helpers.if.call(depth0,null==(stack1=null==(stack1=stack1&&stack1.data)||!1===stack1?stack1:stack1.property)||!1===stack1?stack1:stack1.label,{hash:{},inverse:self.program(8,program8,data),fn:self.programWithDepth(6,program6,data,depth0),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n        </em></li>\n    "},data,depth0),fn:self.programWithDepth(3,function(depth0,data,
depth1){var stack1,helper,buffer="";return buffer+='\n        <li class="row" data-uri="'+escapeExpression(typeof(stack1=null==data||!1===data?data:data.key)===functionType?stack1.apply(depth0):stack1)+'">\n            <div class="label">',stack1=(helper=helpers.label)||typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'</div>\n            <div class="count">\n                <input type="text" value="',stack1=(helper=helpers.value)||typeof(helper=depth0&&depth0.value)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1
)+'" data-increment="1" data-min="'+escapeExpression(typeof(stack1=depth1&&depth1.min)===functionType?stack1.apply(depth0):stack1)+'" data-max="'+escapeExpression(typeof(stack1=depth1&&depth1.max)===functionType?stack1.apply(depth0):stack1)+'" data-zero />\n            </div>\n        </li>\n    '},data,depth0),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n    </ul>\n</section>"})}),define("css!taoBlueprintsCss/distributor",[],function(){}),define("taoBlueprints/component/editor/distributor/distributor",["jquery","lodash","i18n","ui/component","ui/incrementer","tpl!taoBlueprints/component/editor/distributor/distributor",
"css!taoBlueprintsCss/distributor.css"],function($,_,__,component,incrementer,template){"use strict";var defaultConfig={width:"auto",height:300,min:0,max:99};return function($container,config){var distributor=component({getValues:function(){var $component,self=this,values={};return this.is("rendered")&&($component=this.getElement(),$(".row",$component).each(function(){var uri=$(this),$input=$(":text",uri),uri=uri.data("uri");uri&&1===$input.length&&self.config.data.selection[uri]&&(values[uri]={label:self.config.data.selection[uri].label,value:$input.val()})})),values}},defaultConfig);return distributor.on("init",function(){this.render($container)}).on(
"render",function(){var self=this,$component=this.getElement();$component.on("change",function(){self.trigger("change",self.getValues())}),incrementer($component)}).on("disable",function(){this.is("rendered")&&$(":text[data-increment]",this.getElement()).trigger("disable.incrementer")}).on("enable",function(){this.is("rendered")&&$(":text[data-increment]",this.getElement()).trigger("enable.incrementer")}),_.defer(function(){distributor.setTemplate(template).init(config)}),distributor}}),define("tpl!taoBlueprints/component/editor/propertySelector/selector",["handlebars"],function(hb){return hb.template(function(buffer,depth0,helpers,partials,stack1){
this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,buffer.helpers),stack1=stack1||{};var buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing,self=this;function program2(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <a href="#" class="selected" data-uri="',stack1=(helper=helpers.uri)||typeof(helper=depth0&&depth0.uri)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">',stack1=(helper=helpers.label)||typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1
)+"</a>\n        "}function program4(depth0,helper){var options,buffer="";return buffer+='\n        <a href="#" class="selected empty">'+escapeExpression((options={hash:{},data:helper},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Please select a property",options):helperMissing.call(depth0,"__","Please select a property",options)))+"</a>\n        "}return buffer+='<div class="property-selector">\n    ',!(stack1=helpers.if.call(depth0,depth0&&depth0.tree,{hash:{},inverse:self.program(6,function(depth0,helper){var options,buffer="";return buffer+='\n       <span class="txt-warning nothing">'+escapeExpression((options={hash:{},data:helper},(
helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"No eligible property",options):helperMissing.call(depth0,"__","No eligible property",options)))+"</span>\n    "},stack1),fn:self.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+="\n        ",!(stack1=helpers.if.call(depth0,depth0&&depth0.uri,{hash:{},inverse:self.program(4,program4,data),fn:self.program(2,program2,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n        <div class="options folded">\n            <ul>',!(stack1=(helper=helpers.tree)||typeof(helper=depth0&&depth0.tree)===functionType?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(
buffer+=stack1),buffer+="</ul>\n        </div>\n    "},stack1),data:stack1}))&&0!==stack1||(buffer+=stack1),buffer+="\n</div>"})}),define("tpl!taoBlueprints/component/editor/propertySelector/listItem",["handlebars"],function(hb){return hb.template(function(stack1,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,stack1.helpers),data=data||{};var helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<li>\n    <a href="#" data-uri="',buffer+=escapeExpression(stack1=(helper=helpers.uri)||typeof(helper=depth0&&depth0.uri)===functionType?helper.call(depth0,{hash:{},data:data}
):helper)+'">',buffer+=escapeExpression(stack1=(helper=helpers.label)||typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper)+"</a>\n    ",!(stack1=helpers.if.call(depth0,depth0&&depth0.childList,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,buffer="";return buffer+="\n        <ul>\n            ",!(stack1=(stack1=helpers.childList)||typeof(stack1=depth0&&depth0.childList)===functionType?stack1.call(depth0,{hash:{},data:data}):stack1)&&0!==stack1||(buffer+=stack1),buffer+="\n        </ul>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n</li>"})}),define(
"css!taoBlueprintsCss/property-selector",[],function(){}),define("taoBlueprints/component/editor/propertySelector/selector",["jquery","lodash","ui/component","tpl!taoBlueprints/component/editor/propertySelector/selector","tpl!taoBlueprints/component/editor/propertySelector/listItem","css!taoBlueprintsCss/property-selector.css"],function($,_,component,selectorTpl,listItemTpl){"use strict";var buildTree=function(data){function nodeToListItem(acc,node){var item=_.pick(node,["uri","label"]);return node.children&&node.children.length&&(item.childList=_.reduce(node.children,nodeToListItem,"")),acc+=listItemTpl(item)}return _.reduce(data,nodeToListItem,"")}
;return function($container,config){var propertySelector=component({getSelected:function(){var $selected=this.getElement(),$selected=$(".selected",$selected);return!(!$selected.length||$selected.hasClass("empty"))&&{label:$selected.text(),uri:$selected.data("uri")}}},{});return propertySelector.setTemplate(selectorTpl).on("init",function(){this.render($container)}).on("render",function(){var self=this,$component=this.getElement(),$selected=$(".selected",$component),$options=$(".options",$component);$selected.on("click",function(e){e.preventDefault(),$options.toggleClass("folded")}),$options.on("click","a",function(e){var uri=$(this),label=uri.text(),
uri=uri.data("uri");e.preventDefault(),$selected.text(label).data("uri",uri),$options.toggleClass("folded"),self.trigger("change",uri,label)})}),_.defer(function(){config.data&&0<_.size(config.data)&&(config.tree=buildTree(config.data)),propertySelector.init(config)}),propertySelector}}),define("tpl!taoBlueprints/component/editor/editor",["handlebars"],function(hb){return hb.template(function(helper,stack1,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],data=data||{};var options,buffer="",helperMissing=(helpers=this.merge(helpers,helper.helpers)).helperMissing,escapeExpression=this.escapeExpression
;return buffer+='<section class="blueprint-editor form-content">\n    <div class="form-row">\n        <label for="label">'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||stack1&&stack1.__)?helper.call(stack1,"Target Property",options):helperMissing.call(stack1,"__","Target Property",options)))+'</label>\n        <div class="property-selector-container"></div>\n    </div>\n    ',!(stack1=helpers.if.call(stack1,null==(stack1=stack1&&stack1.data)||!1===stack1?stack1:stack1.availableProperties,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,helper){var options,buffer=""
;return buffer+='\n    <div class="distributor-container"></div>\n    <div class="controls">\n        <button class="btn-info small saver"><span class="icon-save"></span> '+escapeExpression((options={hash:{},data:helper},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Save",options):helperMissing.call(depth0,"__","Save",options)))+"</button>\n    </div>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n</section>"})}),define("css!taoBlueprintsCss/editor",[],function(){}),define("taoBlueprints/component/editor/editor",["jquery","lodash","i18n","ui/component","taoBlueprints/component/editor/distributor/distributor",
"taoBlueprints/component/editor/propertySelector/selector","tpl!taoBlueprints/component/editor/editor","css!taoBlueprintsCss/editor.css"],function($,_,__,component,distributorComponent,propertySelectorComponent,editorTpl){"use strict";var defaultConfig={width:500,height:430,data:{property:!1,availableProperties:{},selection:{}}};return function($container,config){var $distributorContainer,$propertySelectorContainer,distributor,selector,editor=component({refresh:function(uri,label,selection){var self=this;return this.is("rendered")&&(this.disable(),distributor&&distributor.destroy(),this.config.data.property={uri:uri,label:label},
this.config.data.selection=selection,distributor=distributorComponent($distributorContainer,_.pick(this.config,["data"])).on("render",function(){self.enable(),self.trigger("refresh")})),this},getValues:function(){var values=_.pick(this.config.data,["selection","property"]);return distributor&&(values.selection=distributor.getValues()),values}},defaultConfig);return editor.on("init",function(){this.render($container)}).on("render",function(){var self=this,$component=this.getElement();$distributorContainer=$(".distributor-container",$component),$propertySelectorContainer=$(".property-selector-container",$component),distributor=distributorComponent(
$distributorContainer,_.pick(config,"data")),selector=propertySelectorComponent($propertySelectorContainer,{uri:config.data.property.uri,label:config.data.property.label,data:config.data.availableProperties||{}}).on("change",function(uri,label){self.trigger("propertyChange",uri,label)}),$(".saver",$component).on("click",function(e){e.preventDefault(),self.is("disabled")||self.trigger("save",self.getValues())})}).on("disable",function(){distributor&&distributor.disable(),selector&&selector.disable()}).on("enable",function(){distributor&&distributor.enable(),selector&&selector.enable()}),_.defer(function(){editor.setTemplate(editorTpl).init(config)}),editor}})
,define("taoBlueprints/controller/Blueprints/editInstance",["jquery","i18n","layout/loading-bar","ui/feedback","taoBlueprints/provider/editor","taoBlueprints/component/editor/editor"],function($,__,loadingBar,feedback,editorProvider,editorComponent){"use strict";var provider=editorProvider(),onError=function(err){feedback().error(err.message),loadingBar.stop()};return{start:function(){var $editorContainer=$(".blueprint-editor-container"),uri=$editorContainer.data("uri");$editorContainer.length&&uri&&(loadingBar.start(),provider.get(uri).then(function(data){editorComponent($editorContainer,{data:data}).on("render",function(){loadingBar.stop()}).on(
"propertyChange",function(propUri,propLabel){var self=this;provider.getSelection(propUri).then(function(selection){self.refresh(propUri,propLabel,selection)}).catch(onError)}).on("save",function(values){provider.save(uri,values).then(function(){feedback().success(__("Blueprint saved"))}).catch(onError)})}).catch(onError))}}}),define("taoBlueprints/controller/routes",[],function(){"use strict";return{Blueprints:{actions:{editInstance:"controller/Blueprints/editInstance"}}}}),function(c){var d=document,a="appendChild",i="styleSheet",s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0][a](s),s[i]?s[i].cssText=c:s[a](d.createTextNode(c)
)}(
".distributor{position:relative;overflow:hidden;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;height:100%;background-color:#fff}.distributor .row{height:40px;display:-ms-flex;display:-webkit-flex;display:flex;-ms-flex-direction:row;-webkit-flex-direction:row;flex-direction:row;-ms-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-content:flex-start;align-content:flex-start;-webkit-align-items:stretch;align-items:stretch}.distributor .row>.label{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:1 1 auto;-webkit-flex:1 1 auto;flex:1 1 auto;-ms-flex:1 1;-webkit-flex:1 1;flex:1 1;padding:10px}.distributor .row>.count{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 100px;-webkit-flex:0 0 100px;flex:0 0 100px;padding:10px}.distributor header{background-color:#D4D5D7}.distributor header.row>.count{padding-left:0}.distributor ul{padding:0;margin:0;overflow-y:auto;list-style-type:none;height:calc(100% - 40px)}.distributor ul .row:nth-child(even){background-color:white}.distributor ul .row:nth-child(odd){background-color:#f4f7f8}.distributor ul .row>.count{padding:5px 10px}.distributor ul .empty{text-align:center}\n\n/*# sourceMappingURL=taoBlueprintsCss/distributor.css.map */.property-selector{padding:5px 0;position:relative}.property-selector a.selected{display:inline-block;position:relative;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;border-radius:3px;padding:3px 10px;text-decoration:none;width:100%}.property-selector a.selected:after{font-family:'tao' !important;speak:never;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;content:\"\\e611\";position:absolute;right:10px;top:7px}.property-selector .nothing{display:inline-block;position:relative;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;border-radius:3px;padding:3px 10px;width:100%;color:#c96043;background-color:#fff}.property-selector .nothing:before{font-family:'tao' !important;speak:never;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;content:\"\\e63b\";margin-right:3px}.property-selector .options{position:absolute;width:100%;background-color:#f3f1ef;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;left:0;margin-top:0;overflow-y:auto;z-index:100;max-height:300px;-webkit-transition:max-height, 300ms, ease, 0s;-moz-transition:max-height, 300ms, ease, 0s;-ms-transition:max-height, 300ms, ease, 0s;-o-transition:max-height, 300ms, ease, 0s;transition:max-height, 300ms, ease, 0s}.property-selector .options.folded{overflow:hidden;max-height:0;-webkit-transition:max-height, 300ms, ease, 0s;-moz-transition:max-height, 300ms, ease, 0s;-ms-transition:max-height, 300ms, ease, 0s;-o-transition:max-height, 300ms, ease, 0s;transition:max-height, 300ms, ease, 0s;border-width:0}.property-selector .options ul{list-style-type:none;padding:0;margin:0 0 0 15px}.property-selector .options ul li{padding-top:5px}.property-selector .options ul li:before{font-family:'tao' !important;speak:never;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;content:\"\\e602\";color:#266d9c;top:2px;margin-right:5px}\n\n/*# sourceMappingURL=taoBlueprintsCss/property-selector.css.map */.blueprint-editor{border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;-moz-border-radius:2px;-webkit-border-radius:2px;border-radius:2px;background-color:#f3f1ef;position:relative;opacity:0;-webkit-transition:opacity, 400ms, linear, 0s;-moz-transition:opacity, 400ms, linear, 0s;-ms-transition:opacity, 400ms, linear, 0s;-o-transition:opacity, 400ms, linear, 0s;transition:opacity, 400ms, linear, 0s}.blueprint-editor.rendered{opacity:1;-webkit-transition:opacity, 400ms, linear, 0s;-moz-transition:opacity, 400ms, linear, 0s;-ms-transition:opacity, 400ms, linear, 0s;-o-transition:opacity, 400ms, linear, 0s;transition:opacity, 400ms, linear, 0s}.blueprint-editor .form-row{display:-ms-flex;display:-webkit-flex;display:flex;-ms-flex-direction:row;-webkit-flex-direction:row;flex-direction:row;-ms-flex-wrap:nowrap;-webkit-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-content:flex-start;align-content:flex-start;-webkit-align-items:stretch;align-items:stretch;padding:10px}.blueprint-editor .form-row>label{margin:0;padding:0;line-height:40px;-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:0 0 120px;-webkit-flex:0 0 120px;flex:0 0 120px}.blueprint-editor .form-row>input,.blueprint-editor .form-row>div{-ms-order:0;-webkit-order:0;order:0;flex-item-align:stretch;-ms-flex-item-align:stretch;-webkit-align-self:stretch;align-self:stretch;-ms-flex:1 1 auto;-webkit-flex:1 1 auto;flex:1 1 auto;-ms-flex:1 1;-webkit-flex:1 1;flex:1 1}.blueprint-editor .distributior-container{padding:10px}.blueprint-editor .controls{padding:10px;text-align:right}\n\n/*# sourceMappingURL=taoBlueprintsCss/editor.css.map */"
),define("taoBlueprints/loader/taoBlueprints.bundle",function(){});
//# sourceMappingURL=taoBlueprints.min.js.map